<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Qué Pasa Bahía Blanca</title>

    <link rel="stylesheet" href="/assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/css/ui-lightness/jquery-ui-1.9.2.custom.min.css">
    <link rel="stylesheet/less" type="text/css" href="/assets/css/style.less">

    <script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <script src="/assets/js/jquery-1.8.3.min.js"></script>
    <script src="/assets/js/jquery-ui-1.9.2.custom.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/less-1.3.1.min.js"></script>

    <script>

        $(window).load(function () {
            // Mapa
            var mapManager = new MapManager({
                mapDivId : "map-canvas",
                mapCenter : {lat: -38.7214, lng: -62.258908},
                googleMapsOptions: {
                    zoom : 12,
                    mapTypeId : google.maps.MapTypeId.ROADMAP
                }
            });

            // Layer de empresas
            mapManager.addFTLayer("empresas", "15BUb-8L7bItsq-N-O0ASG8kIo6ZdKXbMnUI3R4g", "geometry");
            mapManager.addFTLayer("plantas", "1n-HEILAiMokDtCEaUWAzpGR_QkRP9eihyDLW_f0", "posicion");

            // Controles
            $("#time-slider").slider({
                range: true,
                min: 1199145600,        // 01/01/2008 UNIX time
                max: 1356912000,        // 31/12/2012 UNIX time
                step: 60 * 60 * 24,     // 1 day
                values: [1199145600, 1356912000],
                slide: function( event, ui ) {
                    var date0 = new Date(ui.values[0] * 1000);
                    var date1 = new Date(ui.values[1] * 1000);
                    $("#date-from").text(date0.getDate() + "/" + date0.getMonth() + "/" + date0.getFullYear());
                    $("#date-to").text(date1.getDate() + "/" + date1.getMonth() + "/" + date1.getFullYear());
                },
                change: function(event, ui) {
                    console.log("Update map");        //TODO(gb): Remove trace!!!
                }
            });
            var date0 = new Date($( "#time-slider" ).slider( "values", 0 ) * 1000);
            var date1 = new Date($( "#time-slider" ).slider( "values", 1 ) * 1000);
            $("#date-from").text(date0.getDate() + "/" + date0.getMonth() + "/" + date0.getFullYear());
            $("#date-to").text(date1.getDate() + "/" + date1.getMonth() + "/" + date1.getFullYear());
        });
    </script>
</head>

<body>

<div class="container">
    <div class="row">
        <div class="span3">
            <h6>Filtro</h6>
        </div>
        <div class="span9">
            <div id="controls">
                <p>Rango de tiempo: <span class="date" id="date-from"></span> - <span class="date" id="date-to"></span></p>
                <div id="time-slider"></div>
            </div>
            <div id="map-canvas"></div>
        </div>
    </div>
</div>


<!--JS Scripts-->

<script src="/assets/js/MapManager.js"></script>
<script src="/assets/js/FTClient.js"></script>

</body>
</html>